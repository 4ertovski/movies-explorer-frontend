{"ast":null,"code":"import _slicedToArray from\"/Users/les/dev/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import Header from\"../Header/Header\";import Footer from\"../Footer/Footer\";import SearchForm from\"../SearchForm/SearchForm\";import MoviesCardList from\"../MoviesCardList/MoviesCardList\";import'./Movies.css';import{filterMovies,filterDuration}from'../../utils/utils';import*as movies from'../../utils/MoviesApi';/*import movieImage from '../../images/card-saved.png';\n\nconst movies123 = [\n  { _id: 1, image: movieImage, title: '33 слова о дизайне', length: '1ч 42м', saved: true },\n  { _id: 2, image: movieImage, title: 'Киноальманах «100 лет дизайна»', length: '1ч 42м', saved: true },\n  { _id: 3, image: movieImage, title: 'В погоне за Бенкси', length: '1ч 42м', saved: false },\n  { _id: 4, image: movieImage, title: 'Баския: Взрыв реальности', length: '1ч 42м', saved: false },\n  { _id: 5, image: movieImage, title: 'Бег это свобода', length: '1ч 42м', saved: true },\n  { _id: 6, image: movieImage, title: 'Книготорговцы', length: '1ч 42м', saved: false },\n  { _id: 7, image: movieImage, title: 'Когда я думаю о Германии ночью', length: '1ч 42м', saved: false },\n];*/import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Movies=function Movies(_ref){var loggedIn=_ref.loggedIn,handleLikeClick=_ref.handleLikeClick,savedMovies=_ref.savedMovies,onCardDelete=_ref.onCardDelete;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];//загрузка прелоадер\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),initialMovies=_useState4[0],setInitialMovies=_useState4[1];//отфильтрованные по запросу\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),filteredMovies=_useState6[0],setFilteredMovies=_useState6[1];//отфильтрованные по запросу и чекбоксу\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isShortMovies=_useState8[0],setIsShortMovies=_useState8[1];//включен ли чекбокс короткометражек\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isReqErr=_useState10[0],setIsReqErr=_useState10[1];//ошибка запроса к серверу\nvar _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isNotFound=_useState12[0],setIsNotFound=_useState12[1];//фильмы по запросу не найдены\n//основной метод фильрации, который отдает массив с фильмами на рендеринг\nfunction handleFilterMovies(movies,query,short){var moviesList=filterMovies(movies,query,short);//фильтруем полученный массив по запросу\nsetInitialMovies(moviesList);//записываем в стейт\nsetFilteredMovies(short?filterDuration(moviesList):moviesList);//если чекбокс тру, то фильруем по длине и записываем в стейт\nlocalStorage.setItem('movies',JSON.stringify(moviesList));localStorage.setItem('allMovies',JSON.stringify(movies));}function handleShortMovies(){setIsShortMovies(!isShortMovies);if(!isShortMovies){if(filterDuration(initialMovies).length===0){setFilteredMovies(filterDuration(initialMovies));// setIsNotFound(true);\n}else{setFilteredMovies(filterDuration(initialMovies));// setIsNotFound(false);\n}}else{setFilteredMovies(initialMovies);// setIsNotFound(initialMovies.length === 0 ? true : false);\n}localStorage.setItem('shortMovies',!isShortMovies);}//submit\nfunction onSearchMovies(query){console.log(query);localStorage.setItem('movieSearch',query);localStorage.setItem('shortMovies',isShortMovies);if(localStorage.getItem('allMovies')){var _movies=JSON.parse(localStorage.getItem('allMovies'));console.log('lo');handleFilterMovies(_movies,query,isShortMovies);}else{console.log('nolo');setIsLoading(true);movies.getCards().then(function(cardsData){handleFilterMovies(cardsData,query,isShortMovies);setIsReqErr(false);// setAllMovies(cardsData);\n}).catch(function(err){setIsReqErr(true);console.log(err);}).finally(function(){setIsLoading(false);});}}useEffect(function(){if(localStorage.getItem('shortMovies')==='true'){setIsShortMovies(true);}else{setIsShortMovies(false);}},[]);useEffect(function(){if(localStorage.getItem('movies')){var _movies2=JSON.parse(localStorage.getItem('movies'));setInitialMovies(_movies2);if(localStorage.getItem('shortMovies')==='true'){setFilteredMovies(filterDuration(_movies2));}else{setFilteredMovies(_movies2);}}else{// setIsNotFound(true);\n}},[]);useEffect(function(){if(localStorage.getItem('movieSearch')){if(filteredMovies.length===0){setIsNotFound(true);}else{setIsNotFound(false);}}else{setIsNotFound(false);}},[filteredMovies]);return/*#__PURE__*/_jsxs(\"section\",{className:\"movies\",children:[/*#__PURE__*/_jsx(Header,{loggedIn:loggedIn}),/*#__PURE__*/_jsx(SearchForm,{onSearchMovies:onSearchMovies,onFilter:handleShortMovies,isShortMovies:isShortMovies}),/*#__PURE__*/_jsx(MoviesCardList,{savedMovies:savedMovies,cards:filteredMovies,isSavedFilms:false,isLoading:isLoading,isReqErr:isReqErr,isNotFound:isNotFound,handleLikeClick:handleLikeClick,onCardDelete:onCardDelete}),/*#__PURE__*/_jsx(Footer,{})]});};export default Movies;","map":{"version":3,"names":["React","useState","useEffect","Header","Footer","SearchForm","MoviesCardList","filterMovies","filterDuration","movies","jsx","_jsx","jsxs","_jsxs","Movies","_ref","loggedIn","handleLikeClick","savedMovies","onCardDelete","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","initialMovies","setInitialMovies","_useState5","_useState6","filteredMovies","setFilteredMovies","_useState7","_useState8","isShortMovies","setIsShortMovies","_useState9","_useState10","isReqErr","setIsReqErr","_useState11","_useState12","isNotFound","setIsNotFound","handleFilterMovies","query","short","moviesList","localStorage","setItem","JSON","stringify","handleShortMovies","length","onSearchMovies","console","log","getItem","parse","getCards","then","cardsData","catch","err","finally","className","children","onFilter","cards","isSavedFilms"],"sources":["/Users/les/dev/movies-explorer-frontend/src/components/Movies/Movies.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Header from \"../Header/Header\";\nimport Footer from \"../Footer/Footer\";\nimport SearchForm from \"../SearchForm/SearchForm\";\nimport MoviesCardList from \"../MoviesCardList/MoviesCardList\";\nimport './Movies.css';\nimport { filterMovies, filterDuration } from '../../utils/utils';\n\nimport * as movies from '../../utils/MoviesApi';\n\n/*import movieImage from '../../images/card-saved.png';\n\nconst movies123 = [\n  { _id: 1, image: movieImage, title: '33 слова о дизайне', length: '1ч 42м', saved: true },\n  { _id: 2, image: movieImage, title: 'Киноальманах «100 лет дизайна»', length: '1ч 42м', saved: true },\n  { _id: 3, image: movieImage, title: 'В погоне за Бенкси', length: '1ч 42м', saved: false },\n  { _id: 4, image: movieImage, title: 'Баския: Взрыв реальности', length: '1ч 42м', saved: false },\n  { _id: 5, image: movieImage, title: 'Бег это свобода', length: '1ч 42м', saved: true },\n  { _id: 6, image: movieImage, title: 'Книготорговцы', length: '1ч 42м', saved: false },\n  { _id: 7, image: movieImage, title: 'Когда я думаю о Германии ночью', length: '1ч 42м', saved: false },\n];*/\n\nconst Movies = ({loggedIn, handleLikeClick, savedMovies, onCardDelete }) => {\n    const [isLoading, setIsLoading] = useState(false); //загрузка прелоадер\n    const [initialMovies, setInitialMovies] = useState([]); //отфильтрованные по запросу\n    const [filteredMovies, setFilteredMovies] = useState([]); //отфильтрованные по запросу и чекбоксу\n    const [isShortMovies, setIsShortMovies] = useState(false); //включен ли чекбокс короткометражек\n\n    const [isReqErr, setIsReqErr] = useState(false); //ошибка запроса к серверу\n    const [isNotFound, setIsNotFound] = useState(false); //фильмы по запросу не найдены\n    //основной метод фильрации, который отдает массив с фильмами на рендеринг\n    function handleFilterMovies(movies, query, short) {\n        const moviesList = filterMovies(movies, query, short); //фильтруем полученный массив по запросу\n        setInitialMovies(moviesList); //записываем в стейт\n        setFilteredMovies(short ? filterDuration(moviesList) : moviesList); //если чекбокс тру, то фильруем по длине и записываем в стейт\n        localStorage.setItem('movies', JSON.stringify(moviesList));\n        localStorage.setItem('allMovies', JSON.stringify(movies));\n    }\n\n    function handleShortMovies() {\n        setIsShortMovies(!isShortMovies);\n        if (!isShortMovies) {\n            if (filterDuration(initialMovies).length === 0) {\n                setFilteredMovies(filterDuration(initialMovies));\n                // setIsNotFound(true);\n            } else {\n                setFilteredMovies(filterDuration(initialMovies));\n                // setIsNotFound(false);\n            }\n        } else {\n            setFilteredMovies(initialMovies);\n            // setIsNotFound(initialMovies.length === 0 ? true : false);\n        }\n        localStorage.setItem('shortMovies', !isShortMovies);\n    }\n\n    //submit\n    function onSearchMovies(query) {\n        console.log(query);\n\n        localStorage.setItem('movieSearch', query);\n        localStorage.setItem('shortMovies', isShortMovies);\n\n        if (localStorage.getItem('allMovies')) {\n            const movies = JSON.parse(localStorage.getItem('allMovies'));\n            console.log('lo');\n            handleFilterMovies(movies, query, isShortMovies);\n        } else {\n            console.log('nolo');\n            setIsLoading(true);\n            movies\n                .getCards()\n                .then((cardsData) => {\n                    handleFilterMovies(cardsData, query, isShortMovies);\n                    setIsReqErr(false);\n                    // setAllMovies(cardsData);\n                })\n                .catch((err) => {\n                    setIsReqErr(true);\n                    console.log(err);\n                })\n                .finally(() => {\n                    setIsLoading(false);\n                });\n        }\n    }\n\n    useEffect(() => {\n        if (localStorage.getItem('shortMovies') === 'true') {\n            setIsShortMovies(true);\n        } else {\n            setIsShortMovies(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        if (localStorage.getItem('movies')) {\n            const movies = JSON.parse(localStorage.getItem('movies'));\n            setInitialMovies(movies);\n            if (localStorage.getItem('shortMovies') === 'true') {\n                setFilteredMovies(filterDuration(movies));\n            } else {\n                setFilteredMovies(movies);\n            }\n        } else {\n            // setIsNotFound(true);\n        }\n    }, []);\n\n    useEffect(() => {\n        if (localStorage.getItem('movieSearch')) {\n            if (filteredMovies.length === 0) {\n                setIsNotFound(true);\n            } else {\n                setIsNotFound(false);\n            }\n        } else {\n            setIsNotFound(false);\n        }\n    }, [filteredMovies]);\n    return(\n        <section className='movies'>\n            <Header loggedIn={loggedIn} />\n            <SearchForm\n                onSearchMovies={onSearchMovies}\n                onFilter={handleShortMovies}\n                isShortMovies={isShortMovies}/>\n            <MoviesCardList\n                savedMovies={savedMovies}\n                cards={filteredMovies}\n                isSavedFilms={false}\n                isLoading={isLoading}\n                isReqErr={isReqErr}\n                isNotFound={isNotFound}\n                handleLikeClick={handleLikeClick}\n                onCardDelete={onCardDelete}/>\n            <Footer/>\n        </section>\n    )\n}\n\nexport default Movies"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}